# frozen_string_literal: true

class <%= HanamiId.classify repository %> < Hanami::Repository
  def authenticate(login, password)
    resource = find_by(<%= login_column %>: login)
    if resource && resouce.<%= password_column %> == HanamiId::Password.encrypt(password)
      resource
    else
      nil
    end
  end
end
